<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="node_modules/bootstrap/dist/css/bootstrap.min.css">
</head>

<body>
    <div class="container mt-4">
        <form class="d-flex gap-3 mb-3 align-items-center">
            <input type="text" class="form-control" id="create-textbox" />
            <input type="text" class="form-control" id="type-textbox" />
            <select id="number-select" class="form-select">
                <option>Guard</option>
                <option>Center</option>
                <option>Kick Person</option>
            </select>
            <button class="btn btn-primary flex-grow-1" type="submit"
                onclick="addPerson(event)">Add&nbsp;to&nbsp;Table</button>
        </form>
        <table class="table table-striped">
            <tbody id="items-table">
            </tbody>
        </table>
    </div>

    <script>
        /*** DATA (STATE) ***/

        const people = [{ name: "Natalie", type: "Great", position: "Forward", date: new Date(Date.now()) }] // pretend this came from a backend


        /*** RENDER FUNCTIONS ***/

        // Render based on the data
        // Clear what was there before, render it all again

        const createTextbox = document.getElementById("create-textbox")
        const typeTextbox = document.getElementById("type-textbox")
        const numberSelect = document.getElementById("number-select")
        const tableBody = document.querySelector("#items-table")

        function renderPeopleTable() {
            emptyElement(tableBody)
            for (let i = 0; i < people.length; i++) {
                const person = people[i]

                const newRow = document.createElement("tr")
                newRow.innerHTML = `
                <td>${person.name}</td>
                <td>${person.type}</td>
                <td>${person.position}</td>
                <td>${person.date.toLocaleDateString()}</td>
                <td><button id="delete-button" class="btn btn-danger">Delete</button></td>
                <td><button id="update-button" class="btn btn-warning">Update Type to Special</button></td>
            `
                newRow.querySelector("#delete-button").addEventListener("click", () => deletePerson(person) )
                newRow.querySelector("#update-button").addEventListener("click", () => updatePerson(person) )
                tableBody.appendChild(newRow)
            }
        }

        // TO MAKE LEGIT: get the data from backend
        renderPeopleTable() // when the app first loads in
    

        /*** EVENT LISTENERS ***/

        // Change the data, and then call the render functions

        function addPerson(event) {
            event.preventDefault()

            // Make the newly created piece of data
            const newPerson = {
                name: createTextbox.value,
                type: typeTextbox.value,
                position: numberSelect.value,
                date: new Date(Date.now())
            }

            // Adding it to the state (data)
            people.push(newPerson)

            // TO MAKE LEGIT: Add it to the backend
            

            // Render again
            renderPeopleTable()

            // Clear the form
            createTextbox.value = ""
            typeTextbox.value = ""
        }

        function deletePerson(personToDelete) {
            console.log("personToDelete", personToDelete)
            // Update the data
            const indexToRemove = people.indexOf(personToDelete)
            people.splice(indexToRemove, 1)

            // TO MAKE LEGIT: Add it to the backend
            


            // Make it so
            renderPeopleTable()
        }

        function updatePerson(personToUpdate) {
            console.log("personToUpdate", personToUpdate)
            // Update the data
            personToUpdate.type = "Special"

            // TO MAKE LEGIT: Add it to the backend
            

            // Make it so
            renderPeopleTable()
        }

        // HELPER

        function emptyElement(element) {
            while (element.firstChild) {
                element.removeChild(element.firstChild)
            }
        }

    </script>
</body>

</html>

<!-- GREAT BEFORE -->