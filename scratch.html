<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <input type="text" id="todo-input" onkeypress="onType()" />
    <button onclick="addTodo()">Add Todo</button>
    <button onclick="clearTodos()">Clear All Todos</button>
    <ul id="todo-list"></ul>

    <script src="node_modules/jquery/dist/jquery.min.js"></script>
    <script>
        const $input = $("#todo-input")
        const $list = $("#todo-list")

        let todoList = ["Laundry", "Dishes"]; // these todos could have come from the backend or whatever

        // When the page first loads
        window.addEventListener("load", () => {
            renderTodoList();
        })

        function onType() {
            if (event.keyCode === 13) { // 13 is the enter key
                addTodo();
            }
        }
        
        /**** RENDERING CODE *****/

        function renderTodoList() {
            // Empty it out
            $list.empty();
            // Fill it up with todos based on the data
            for(const todoItem of todoList) {
                $list.append( renderTodo(todoItem) )
            }
        }

        function renderTodo(todoText) {
            const $listItem = $("<li/>")
                .text(todoText)
                .on("click", () => deleteTodo(todoText))
            return $listItem;
        }

        /***** EVENT LISTENERS *****/

        function addTodo() {
            const newTodoText = $input.val();

            todoList.push(newTodoText)

            $input.val("")

            renderTodoList();
        }

        function updateTodo(index, newTodoText) {
            // Update the data
            todoList[index] = newTodoText;

            // Rerender based on the data
            renderTodoList();
        }

        function deleteTodo(todoText) {
            // Update the data
            todoList = todoList.filter(todo => todo !== todoText) // should be working off ids not just the text

            // Rerender based on the data
            renderTodoList();
        }

        function clearTodos() {
            todoList = [];

            renderTodoList();
        }
    </script>
</body>
</html>
